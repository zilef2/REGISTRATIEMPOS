import{l as J,T as X,D as H,y as K,m as O,f as n,a as s,w as R,o as c,b as r,t as v,u as o,g as p,d as $,n as Q,e as W}from"./app-dd94624b.js";import{_ as u}from"./InputError-99b22b36.js";import{_ as j,a as f}from"./TextInput-421a4c9d.js";import{_ as Y,a as Z}from"./SecondaryButton-320d8f83.js";import{_ as ee}from"./PrimaryButton-f5a76b26.js";import{C as b}from"./vue-select-a04d1989.js";import"./vue-datepicker-2ac9f674.js";import{L as T}from"./global-32514258.js";const oe={class:"space-y-6"},ae={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ie={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-6"},de={key:0,id:"opcinesActividadO",class:"xl:col-span-2 col-span-1"},te=r("label",{name:""}," Reportar en nombre de: ",-1),le={id:"opcinesActividadO",class:"xl:col-span-2 col-span-1"},se=r("label",{name:""}," Tipo de reporte ",-1),re={class:"xl:col-span-1 col-span-1"},ne={class:"col-span-1"},ce={key:1,id:"Sordentrabajo",class:"xl:col-span-2 col-span-1"},pe=r("label",{name:"ordentrabajo_ids"}," Orden de trabajo ",-1),me={key:2,class:"w-full lg:col-span-2 col-span-1"},_e={key:3,class:"w-full col-span-1"},ue={id:"Scentrotrabajo",class:"col-span-1"},be=r("label",{name:"centrotrabajo_id"}," Centro de trabajo ",-1),ve={key:4,class:"col-span-1"},ge={key:5,id:"Sactividad",class:"xl:col-span-2 col-span-1"},je=r("label",{name:"label_actividad_id"}," Actividad ",-1),fe={key:6,id:"Sreproceso",class:"xl:col-span-2 col-span-1"},Te=r("label",{name:"reproceso_id"}," Reproceso",-1),he={key:7,id:"Sdisponibilidad",class:"xl:col-span-3 col-span-1"},ye=r("label",{name:"disponibilidad_id"}," Disponibilidad",-1),Ve={class:"mb-8 mt-[360px] flex justify-end"},xe={key:0,class:"mx-12 px-8 text-lg font-medium text-red-600 bg-red-50 dark:text-gray-100"},Oe={key:1,class:"mx-12 px-8 text-lg font-medium text-gray-800 dark:text-gray-100"},Ue={__name:"Edit",props:{show:Boolean,title:String,generica:Object,losSelect:Object,numberPermissions:Number,valuesGoogleCabeza:Object,valuesGoogleBody:Object,Trabajadores:Object},emits:["close"],setup(F,{emit:h}){const d=F,S=[{title:"Actividad",value:0},{title:"Reproceso",value:1},{title:"Disponibilidad(paro)",value:2}],y=["Nombre Tablero","% avance","OT+Item","Tiempo estimado"],V=["Nombre_tablero","avance"],t=J({params:{pregunta:""},actividad_id:d.losSelect.actividad,centrotrabajo_id:d.losSelect.centrotrabajo,disponibilidad_id:d.losSelect.disponibilidad,ordentrabajo_id:d.losSelect.ordentrabajo,ordenTemporal:[],reproceso_id:d.losSelect.reproceso,temp_disponibilidad_id:null,temp_reproceso_id:null,temp_actividad_id:null,valorInactivo:"NA",cabeza:d.valuesGoogleCabeza,nombresOT:Object.values(d.valuesGoogleBody),ordentrabajo_ids:[],mensajeFalta:"",BanderaTipo:!0,mensajeTiemposAuto:"",soloUnaVez:!0}),e=X({...Object.fromEntries(["tipoReporte","fecha","hora_inicial","hora_final","actividad_id","centrotrabajo_id","disponibilidad_id","operario_id","ordentrabajo_id","reproceso_id","ordentrabajo_ids","otitem","user_id","nombreTablero","OTItem","TiempoEstimado"].map(a=>[a,""]))});H(()=>{d.numberPermissions>9});const G=["Tiempo_estimado_corte","Tiempo_estimado_doblez","Tiempo_estimado_soldadura","Tiempo_estimado_pulida","Tiempo_estimado_ensamble","Tiempo_estimado_cobre","Tiempo_estimado_cableado","Tiempo_estimado_Ing_mec","Tiempo_estimado_Ing_elec"];K(()=>{if(d.show){if(e.errors={},e.ordentrabajo_ids&&e.ordentrabajo_ids.value!=null){e.nombreTablero=t.nombresOT[e.ordentrabajo_ids.value][V[0]],e.OTItem=t.nombresOT[e.ordentrabajo_ids.value].Item;let a=e.centrotrabajo_id.value-1;e.TiempoEstimado=t.nombresOT[e.ordentrabajo_ids.value][G[a]]}}else t.BanderaTipo=!0});let x=a=>{let i="";try{a.forEach((l,g)=>{if(typeof e[l]>"u"||e[l]===null||e[l].length===0)throw i=l,new Error("BreakException")})}catch{}return i},M=()=>{let a=e.tipoReporte.value,i=!0;const l=" es obligatorio";a==0&&(i=x(["ordentrabajo_ids","centrotrabajo_id","actividad_id"])),a==1&&(i=x(["centrotrabajo_id","ordentrabajo_ids","actividad_id","reproceso_id"])),a==2&&(i=x(["centrotrabajo_id","disponibilidad_id"]));let g={ordentrabajo_ids:"Orden trabajo",actividad_id:"Actividad",reproceso_id:"Reproceso",centrotrabajo_id:"Centro de trabajo",disponibilidad_id:"Disponibilidad"};return i!=""?g[i]+l:i};const q=()=>{var i;e.ordentrabajo_id=e.ordentrabajo_ids,console.log("ðŸ§ˆ debu form.tipoReporte.value:",e.tipoReporte.value),t.mensajeFalta=M();let a;a=T(d.losSelect.centrotrabajo,e.centrotrabajo_id),e.centrotrabajo_id=a!=""?a:"",e.tipoReporte.value===0&&(a=T(d.losSelect.actividad,e.actividad_id),e.actividad_id=a!=""?a:""),e.tipoReporte.value===1&&(a=T(d.losSelect.actividad,e.actividad_id),e.actividad_id=a!=""?a:"",a=T(d.losSelect.reproceso,e.reproceso_id),e.reproceso_id=a!=""?a:""),e.tipoReporte.value===2&&(a=T(d.losSelect.disponibilidad,e.disponibilidad_id),e.disponibilidad_id=a!=""?a:""),t.mensajeFalta==""&&e.put(route("reporte.update",(i=d.generica)==null?void 0:i.id),{preserveScroll:!0,onSuccess:()=>{h("close"),e.reset()},onError:()=>alert(JSON.stringify(e.errors,null,4)),onFinish:()=>null})};return O(()=>e.ordentrabajo_ids,a=>{t.soloUnaVez=!0}),O(()=>d.show,()=>{var a,i,l,g,k,w,E,I,C,B,N,U,A,D;if(t.BanderaTipo){t.BanderaTipo=!1,e.tipoReporte=S[(a=d.generica)==null?void 0:a.tipoReporte],t.ordentrabajo_ids=t.nombresOT.map((_,m)=>{var z;return{title:(z=_.Item)==null?void 0:z.replace(/_/g," "),value:m}}),t.ordenTemporal=t.nombresOT.map((_,m)=>({value:m,valueID:_.id}));let P=t.ordenTemporal.findIndex(_=>{var m;return _.valueID==((m=d.generica)==null?void 0:m.ordentrabajo_id)});e.ordentrabajo_ids=t.ordentrabajo_ids[P],e.centrotrabajo_id=t.centrotrabajo_id[(i=d.generica)==null?void 0:i.centrotrabajo_id],e.actividad_id=t.actividad_id[(l=d.generica)==null?void 0:l.actividad_id]?t.actividad_id[(g=d.generica)==null?void 0:g.actividad_id]:null,e.disponibilidad_id=t.disponibilidad_id[(k=d.generica)==null?void 0:k.disponibilidad_id]?t.disponibilidad_id[(w=d.generica)==null?void 0:w.disponibilidad_id]:null,e.reproceso_id=t.reproceso_id[(E=d.generica)==null?void 0:E.reproceso_id]?t.reproceso_id[(I=d.generica)==null?void 0:I.reproceso_id]:null,e.cantidad=(C=d.generica)==null?void 0:C.cantidad,e.fecha=(B=d.generica)==null?void 0:B.fecha,e.hora_inicial=(N=d.generica)==null?void 0:N.hora_inicial;let L=d.Trabajadores.findIndex(_=>{var m;return _.value==((m=d.generica)==null?void 0:m.operario_id)});e.user_id=d.Trabajadores[L],e.nombreTablero=(U=d.generica)==null?void 0:U.nombreTablero,e.OTItem=(A=d.generica)==null?void 0:A.OTItem,e.TiempoEstimado=(D=d.generica)==null?void 0:D.TiempoEstimado}else t.BanderaTipo=!d.show}),O(()=>e.centrotrabajo_id,(a,i)=>{if(a&&typeof a.value<"u"){let l="centrotrabajo"+a.title;t.actividad_id=d.losSelect[l],a.value!=d.generica.centrotrabajo_id&&(e.actividad_id={title:"Seleccione actividad",value:null})}}),(a,i)=>(c(),n("section",oe,[s(Y,{show:d.show,onClose:i[12]||(i[12]=l=>(h("close"),t.BanderaTipo=!0))},{default:R(()=>[r("form",{class:"px-6 my-8",onSubmit:i[11]||(i[11]=W((...l)=>a.create&&a.create(...l),["prevent"]))},[r("h2",ae,v(a.lang().label.edit)+" "+v(d.title),1),r("div",ie,[d.numberPermissions>8?(c(),n("div",de,[te,s(o(b),{options:d.Trabajadores,label:"title",modelValue:o(e).user_id,"onUpdate:modelValue":i[0]||(i[0]=l=>o(e).user_id=l)},null,8,["options","modelValue"])])):p("",!0),r("div",le,[se,s(o(b),{options:S,label:"title",disabled:"",modelValue:o(e).tipoReporte,"onUpdate:modelValue":i[1]||(i[1]=l=>o(e).tipoReporte=l)},null,8,["modelValue"])]),r("div",re,[s(j,{for:"fecha",value:a.lang().label.fecha},null,8,["value"]),s(f,{id:"fecha",type:"date",class:"mt-1 block w-full bg-gray-200",modelValue:o(e).fecha,"onUpdate:modelValue":i[2]||(i[2]=l=>o(e).fecha=l),disabled:"",placeholder:"fecha",error:o(e).errors.fecha},null,8,["modelValue","error"]),s(u,{class:"mt-2",message:o(e).errors.fecha},null,8,["message"])]),r("div",ne,[s(j,{for:"hora_inicial",value:a.lang().label["hora inicial"]},null,8,["value"]),s(f,{id:"hora_inicial",type:"time",class:"mt-1 block w-full bg-gray-200",modelValue:o(e).hora_inicial,"onUpdate:modelValue":i[3]||(i[3]=l=>o(e).hora_inicial=l),disabled:"",placeholder:"hora_inicial",error:o(e).errors.hora_inicial,step:"3600"},null,8,["modelValue","error"]),s(u,{class:"mt-2",message:o(e).errors.hora_inicial},null,8,["message"])]),o(e).tipoReporte.value!=2?(c(),n("div",ce,[pe,s(o(b),{options:t.ordentrabajo_ids,label:"title",modelValue:o(e).ordentrabajo_ids,"onUpdate:modelValue":i[4]||(i[4]=l=>o(e).ordentrabajo_ids=l)},null,8,["options","modelValue"]),s(u,{class:"mt-2",message:o(e).errors.ordentrabajo_id},null,8,["message"])])):p("",!0),o(e).ordentrabajo_ids&&o(e).tipoReporte.value!=2?(c(),n("div",me,[s(j,{for:"index",value:y[0]},null,8,["value"]),s(f,{id:"index",type:"text",disabled:"",class:"mt-1 block w-full bg-gray-200",value:t.nombresOT[o(e).ordentrabajo_ids.value][V[0]]},null,8,["value"])])):p("",!0),o(e).ordentrabajo_ids&&o(e).tipoReporte.value!=2?(c(),n("div",_e,[s(j,{for:"index",value:y[1]},null,8,["value"]),s(f,{id:"index",type:"text",disabled:"",class:"mt-1 block w-full bg-gray-200",value:t.nombresOT[o(e).ordentrabajo_ids.value][V[1]]},null,8,["value"])])):p("",!0),r("div",ue,[be,s(o(b),{options:t.centrotrabajo_id,label:"title",modelValue:o(e).centrotrabajo_id,"onUpdate:modelValue":i[5]||(i[5]=l=>o(e).centrotrabajo_id=l)},null,8,["options","modelValue"]),s(u,{class:"mt-2",message:o(e).errors.centrotrabajo_id},null,8,["message"])]),o(e).ordentrabajo_ids&&o(e).centrotrabajo_id&&o(e).tipoReporte.value!=2?(c(),n("div",ve,[s(j,{for:"index",value:y[3]},null,8,["value"]),s(f,{id:"index",type:"text",disabled:"",class:"mt-1 block w-full bg-gray-200",modelValue:o(e).TiempoEstimado,"onUpdate:modelValue":i[6]||(i[6]=l=>o(e).TiempoEstimado=l)},null,8,["modelValue"])])):p("",!0),o(e).tipoReporte.value==0||o(e).tipoReporte.value==1?(c(),n("div",ge,[je,s(o(b),{options:t.actividad_id,label:"title",required:"",modelValue:o(e).actividad_id,"onUpdate:modelValue":i[7]||(i[7]=l=>o(e).actividad_id=l)},null,8,["options","modelValue"]),s(u,{class:"mt-2",message:o(e).errors.actividad_id},null,8,["message"])])):p("",!0),o(e).tipoReporte.value==1?(c(),n("div",fe,[Te,s(o(b),{options:t.reproceso_id,label:"title",required:"",modelValue:o(e).reproceso_id,"onUpdate:modelValue":i[8]||(i[8]=l=>o(e).reproceso_id=l)},null,8,["options","modelValue"]),s(u,{class:"mt-2",message:o(e).errors.reproceso_id},null,8,["message"])])):p("",!0),o(e).tipoReporte.value==2?(c(),n("div",he,[ye,s(o(b),{options:t.disponibilidad_id,label:"title",required:"",modelValue:o(e).disponibilidad_id,"onUpdate:modelValue":i[9]||(i[9]=l=>o(e).disponibilidad_id=l)},null,8,["options","modelValue"]),s(u,{class:"mt-2",message:o(e).errors.disponibilidad_id},null,8,["message"])])):p("",!0)]),r("div",Ve,[t.mensajeFalta!=""?(c(),n("h2",xe,v(t.mensajeFalta),1)):p("",!0),t.mensajeTiemposAuto!=""?(c(),n("h2",Oe,v(t.mensajeTiemposAuto),1)):p("",!0),s(Z,{disabled:o(e).processing,onClick:i[10]||(i[10]=l=>h("close"))},{default:R(()=>[$(v(a.lang().button.close),1)]),_:1},8,["disabled"]),s(ee,{class:Q(["ml-3",{"opacity-25":o(e).processing}]),disabled:o(e).processing,onClick:q},{default:R(()=>[$(v(o(e).processing?a.lang().button.save+"...":a.lang().button.save),1)]),_:1},8,["class","disabled"])])],32)]),_:1},8,["show"])]))}};export{Ue as default};
